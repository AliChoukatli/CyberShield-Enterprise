# 07 - Windows Autopilot - AzureAD Join

## ðŸŽ¯ Objective

Simulate a modern Windows 11 deployment using **Windows Autopilot** and **Microsoft Intune**, without relying on on-premises infrastructure. This lab demonstrates how to register a device for Autopilot, create and assign deployment profiles, and trigger an automatic enrollment during the deviceâ€™s Out-of-Box Experience (OOBE).

---

## ðŸ§° Prerequisites

| Component                            | Details                                                                                                 |
|--------------------------------------|---------------------------------------------------------------------------------------------------------|
| âœ… Microsoft 365 E3 tenant           | Created from [developer.microsoft.com](https://developer.microsoft.com/en-us/microsoft-365/dev-program) |
| âœ… Intune enabled                    | Check access via [https://endpoint.microsoft.com](https://endpoint.microsoft.com)                       |
| âœ… Windows 11 VM (Pro or Enterprise) | Installed using official evaluation ISO                                                                 |
| âœ… PowerShell Admin on the VM | Required to extract the Hardware Hash (HWID)                                                                   |

---

## ðŸ§± Folder Structure

```bash
07_Autopilot/
â”œ
```
---

## âœ… Step-by-step Instructions

### ðŸ§© Step 1 â€“ Create your Microsoft 365 Dev tenant

Instead of using the Instant Sandbox provided by the Microsoft 365 Developer Program, this lab uses a manually created Microsoft 365 E5 Developer Trial (P2) tenant, which includes Intune.

### âœ… Instructions:

1. Go to [Microsoft website to buy the licence](https://www.microsoft.com/en-ca/microsoft-365/enterprise/e3?activetab=pivot:overviewtab) > Try for free
2. Fill out the registration form with your details.  
3. Provide your credit card information for verification purposes.  
4. After the verification process completes, you will be redirected to your Microsoft 365 dashboard.  

![Dashboard_E3](https://github.com/AliChoukatli/CyberShield-Enterprise/blob/main/07_Autopilot/Screenshots/Licence_E3.png)

---

# Windows Autopilot Deployment Guide

## Step 2 â€“ Create an Autopilot Deployment Profile

1. Go to [https://endpoint.microsoft.com](https://endpoint.microsoft.com).

2. Navigate to:  
   `Devices > Enrollment > Deployment Profiles`

3. Click **+ Create profile**.

4. Select **Windows PC**.

5. Enter a **Name** for the profile (e.g., `Autopilot Azure AD User-Driven`).

6. Configure the **Out-of-box experience (OOBE)** settings:

   - **Join to Azure AD as:** `Azure AD joined`  
   - **User account type:** `Standard` (for user-driven mode)  
   - **Hide privacy settings:** Enabled (to skip privacy prompts during setup)  
   - **Disable Cortana:** Enabled (toggle **Allow Cortana** to **No**)  
   - **Skip keyboard selection page:** Enabled (optional)  
   - (Other settings like Language and Locale can be configured here if needed.)

7. Click **Create** to finish creating the deployment profile.

---

## Step 3 â€“ Generate the Hardware ID (HWID) from the VM

1. Launch your Windows 11 VM (Pro or Enterprise).

2. Open **PowerShell as Administrator**.

3. Run the following commands to install the script and export the hardware hash:

   ```powershell
   Install-Script -Name Get-WindowsAutopilotInfo -Force
   Get-WindowsAutopilotInfo -OutputFile AutoPilotHWID.csv
   ```
4. Transfer the generated AutoPilotHWID.csv file to your host machine.

## Step 4 â€“ Import the Device into Intune

1. In Endpoint Manager, navigate to:  
   `Devices > Windows > Windows enrollment > Devices`

2. Click **Import**.

3. Upload the `AutoPilotHWID.csv` file.

4. Wait until the device appears in the list.

---

## Step 5 â€“ Assign the Autopilot Profile to the Device

1. Select the imported device from the list.

2. Click **Assign profile**.

3. Choose the deployment profile you created earlier.

4. Confirm the assignment.

---

## Step 6 â€“ Reset or Reinstall the VM to Trigger Autopilot

1. Optionally, reset or reinstall the Windows 11 VM.

2. On first boot, the device will contact Autopilot service and begin automatic enrollment.

3. Intune will apply the assigned profile and policies.

---

## Optional Captures (Screenshots to include in your project):

- `2-profile-creation-1.png` â€“ Profile creation start  
- `3-profile-creation-2.png` â€“ Profile settings configuration  
- `4-powershell-hwid.png` â€“ Generating hardware hash with PowerShell  
- `5-import-device.png` â€“ Device import screen  
- `6-device-imported.png` â€“ Device listed after import  
- `7-assign-profile.png` â€“ Assign profile to device  
- `8-oobe-start.png` â€“ OOBE start on VM reset  
- `9-intune-autoconfig.png` â€“ Intune automatic configuration  


