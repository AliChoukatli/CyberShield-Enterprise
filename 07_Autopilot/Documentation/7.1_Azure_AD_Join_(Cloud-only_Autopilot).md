# 07 - Windows Autopilot - AzureAD Join

## ðŸŽ¯ Objective

Simulate a modern Windows 11 deployment using **Windows Autopilot** and **Microsoft Intune**, without relying on on-premises infrastructure. This lab demonstrates how to register a device for Autopilot, create and assign deployment profiles, and trigger an automatic enrollment during the deviceâ€™s Out-of-Box Experience (OOBE).
> Instead of using the Instant Sandbox provided by the Microsoft 365 Developer Program, this lab uses a Microsoft 365 E3 Trial tenant, where Intune was available by default. This setup allows full access to Endpoint Manager and Autopilot features.
---

## ðŸ§° Prerequisites

| Component                            | Details                                                                                                 |
|--------------------------------------|---------------------------------------------------------------------------------------------------------|
| âœ… Microsoft 365 E3 tenant           | Created from [Microsoft 365 E3 ](https://www.microsoft.com/en-ca/microsoft-365/enterprise/e3?activetab=pivot:overviewtab) |
| âœ… Intune enabled                    | Check access via [https://endpoint.microsoft.com](https://endpoint.microsoft.com)                       |
| âœ… Windows 11 VM (Pro or Enterprise) | Installed using official evaluation ISO                                                                 |
| âœ… PowerShell Admin on the VM | Required to extract the Hardware Hash (HWID)                                                                   |

---

## ðŸ§± Folder Structure

```bash
07_Autopilot/
â”œ
```
---

## âœ… Step-by-step Instructions


### ðŸ§© Step 1 â€“ Create your Microsoft 365 Dev tenant

### âœ… Instructions:

1. Go to [Microsoft website to buy the licence](https://www.microsoft.com/en-ca/microsoft-365/enterprise/e3?activetab=pivot:overviewtab) > Try for free
2. Fill out the registration form with your details.  
3. Provide your credit card information for verification purposes.  
4. After the verification process completes, you will be redirected to your Microsoft 365 dashboard.  

![Dashboard_E3](https://github.com/AliChoukatli/CyberShield-Enterprise/blob/main/07_Autopilot/Screenshots/Licence_E3.png)

---

## ðŸ§© Step 2 â€“ Creating Dynamic Group for Windows 10/11 Devices 
> it's recommended to create a **dynamic Azure AD device group** that automatically includes all Windows 10 and Windows 11 devices.
> This group can then be assigned an Autopilot deployment profile, so all devices in the group receive the correct configuration automatically.

1. Go to the [Entra ID Portal](entra.microsoft.com) and navigate to  **Groups > New Group**.  
2. Set the following parameters:
   - **Group type:** `Security`
   - **Group name:** `Windows 10/11 Devices`  
   - **Membership type:** `Dynamic Device`
3. Click **Add dynamic query** and in the **Rule syntax** box, enter the following rule:
```kql
(device.deviceOSType -eq "Windows") and ((device.deviceOSVersion -startsWith "10") or (device.deviceOSVersion -startsWith "11"))
```
![Win10/11 Devices_rule](https://github.com/AliChoukatli/CyberShield-Enterprise/blob/main/07_Autopilot/Screenshots/win10-11_devices_group.png)

4. Click **Create**
   
## ðŸ§© Step 3 â€“ Create an Autopilot Deployment Profile

1. Go to [Intune](https://intune.microsoft.com)
2. Navigate to:  
   `Devices > Enrollment > Deployment Profiles`  
3. Click **+ Create profile**.  
4. Select **Windows PC**.  
5. Enter a **Name** for the profile (e.g., `Autopilot_AzureAD_UserDriven`).
6. Set Convert all targeted devices to Autopilot to `No`.
7. Configure the Out-of-box experience (OOBE) settings:
   - **Deployment mode** : ` User-Driven`
   - **Join to MicrosoftEntra ID as**:`Microsoft Entra Joined`
   - **Microsoft Software License Term**: `Hide`.
   - **Privacy settings**:`Hide` (to skip privacy prompts during setup).
   - **Hide change account options** : `Hide`.
   - **User account type**: `Standard`  
   - **Allow pre-provisioned deployment**: `NO`
   - **Language (Region)** : `Operating system default`.
   - **Automatically configure keyboard**: `Yes` (So that the keyboard is automatically configured according to the language.)
   - **Apply device name template**: `No` (Unless you want to apply an automatic naming convention to device names.)
  
8. Click on Assignments

- Choose the device groups or specific devices that should receive this Autopilot profile. eg: Widnows 10/11 Devices.

![Autopilot_Profile](https://github.com/AliChoukatli/CyberShield-Enterprise/blob/main/07_Autopilot/Screenshots/autopilot_profile.png)

9. Click **Create** to finish creating the deployment profile.

---

## ðŸ§© Step 4 â€“ Wait for the device to appear in Intune

When using the `-Online` method, the device's hardware hash is uploaded directly to your Intune tenant. There is no need to manually export or import a CSV file.

In the Microsoft Intune admin center, navigate to:

**Devices > Windows > Windows enrollment > Devices**

Click on **Sync** to refresh the device list.

The device should now appear in the **Windows Autopilot devices** list.

---

## ðŸ§© Step 5 â€“ Assign the Autopilot profile to the device

This step remains the same as in the traditional procedure. Once the device is listed, you can assign an Autopilot deployment profile to it.

- Select the device from the list.
- Click **Assign Profile**.
- Choose the deployment profile you previously created.
- Confirm the assignment.

---

âœ… **Summary**

Using the `-Online` method significantly simplifies Steps 3 and 4:

- No need to generate, inspect, or upload a CSV file.
- The device is registered directly in Intune.
- The flow is faster and less error-prone.
