# 07 - Windows Autopilot - AzureAD Join

## ðŸŽ¯ Objective

Simulate a modern Windows 11 deployment using **Windows Autopilot** and **Microsoft Intune**, without relying on on-premises infrastructure. This lab demonstrates how to register a device for Autopilot, create and assign deployment profiles, and trigger an automatic enrollment during the deviceâ€™s Out-of-Box Experience (OOBE).

---

## ðŸ§° Prerequisites

| Component | Details |
|----------|---------|
| âœ… Microsoft 365 E5 Developer tenant | Created from [developer.microsoft.com](https://developer.microsoft.com/en-us/microsoft-365/dev-program) |
| âœ… Intune enabled | Check access via [https://endpoint.microsoft.com](https://endpoint.microsoft.com) |
| âœ… Windows 11 VM (Pro or Enterprise) | Installed using official evaluation ISO |
| âœ… PowerShell Admin on the VM | Required to extract the Hardware Hash (HWID) |

---

## ðŸ§± Folder Structure

```bash
07_Autopilot/
â”œâ”€â”€ README.md
â”œâ”€â”€ captures/
â”‚   â”œâ”€â”€ 1-tenant-created.png
â”‚   â”œâ”€â”€ 2-profile-creation-1.png
â”‚   â”œâ”€â”€ 3-profile-creation-2.png
â”‚   â”œâ”€â”€ 4-powershell-hwid.png
â”‚   â”œâ”€â”€ 5-import-device.png
â”‚   â”œâ”€â”€ 6-device-imported.png
â”‚   â”œâ”€â”€ 7-assign-profile.png
â”‚   â”œâ”€â”€ 8-oobe-start.png (optional)
â”‚   â””â”€â”€ 9-intune-autoconfig.png (optional)
â””â”€â”€ scripts/
    â””â”€â”€ Get-WindowsAutopilotInfo.ps1
# 07_Autopilot - Windows Autopilot Deployment Guide
```
---

## âœ… Step-by-step Instructions

### ðŸ§© Step 1 â€“ Create your Microsoft 365 Dev tenant

Instead of using the Instant Sandbox provided by the Microsoft 365 Developer Program, this lab uses a manually created Microsoft 365 E5 Developer Trial (P2) tenant, which includes Intune.

### âœ… Instructions:

1. Go to [https://signup.microsoft.com](https://signup.microsoft.com).  
2. Enter your work or school email address.  
3. Click on **Set up account**.  
4. Fill out the registration form with your details.  
5. Provide your credit card information for verification purposes.  
6. After the verification process completes, you will be redirected to your Microsoft 365 dashboard.  

![Dashboard_P2](https://github.com/AliChoukatli/CyberShield-Enterprise/blob/main/07_Autopilot/Screenshots/Licence_P2.png)

---

### ðŸ§© Step 2 â€“ Create an Autopilot deployment profile

1. Go to [https://endpoint.microsoft.com](https://endpoint.microsoft.com)  
2. Navigate to:  
   `Devices > Windows > Enrollment > Deployment Profiles`  
3. Click **+ Create Profile**  
4. Choose:  
   - Platform: **Windows PC**  
   - Join type: **Azure AD joined**  
   - Deployment mode: **User-driven**  
   - Configure settings (disable privacy/Cortana)  

ðŸ“¸ Captures:  
- `2-profile-creation-1.png`  
- `3-profile-creation-2.png`

---

### ðŸ§© Step 3 â€“ Generate the Hardware ID (HWID) from the VM

1. Launch your Windows 11 VM (Pro or Enterprise)  
2. Open PowerShell as administrator  
3. Run the following commands:

```powershell
Install-Script -Name Get-WindowsAutopilotInfo -Force
Get-WindowsAutopilotInfo -OutputFile AutoPilotHWID.csv
```

4. Transfer the `.csv` file to your host machine if needed

ðŸ“¸ Capture: `4-powershell-hwid.png`

---

### ðŸ§© Step 4 â€“ Import the device into Intune

Go to:  
`Devices > Windows > Windows Enrollment > Devices`

Click **Import**

Upload the `AutoPilotHWID.csv` file

Wait until the device appears in the list

ðŸ“¸ Captures:  
- `5-import-device.png`  
- `6-device-imported.png`

---

### ðŸ§© Step 5 â€“ Assign the Autopilot profile to the device

Select the imported device

Click **Assign Profile**

Choose the profile created earlier

Confirm the assignment

ðŸ“¸ Capture: `7-assign-profile.png`

---

### ðŸ§© Step 6 â€“ Reset or reinstall the VM and trigger Autopilot

*(Optional but strongly recommended if time allows)*

- Reinstall or reset the Windows 11 VM  
- On first boot, the device will reach out to Autopilot and begin automatic enrollment  
- Intune will apply policies and settings

ðŸ“¸ Optional Captures:  
- `8-oobe-start.png`  
- `9-intune-autoconfig.png`

---

### ðŸ§  Notes

- This lab replicates a modern device provisioning scenario using Microsoft Autopilot.  
- It is cloud-native: no on-prem server or Active Directory is required.  
- Autopilot is often used by IT departments to preconfigure and ship devices to users without manual setup.  
- The Windows 11 VM uses an evaluation license from Microsoft Eval Center.
